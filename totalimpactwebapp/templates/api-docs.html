{% extends "base.html" %}

{% block content %}

<script type="text/javascript">
   mixpanel.track("View:docs", {"Doc Type": "api docs"});
</script>

<div class="main" id="docs" xmlns="http://www.w3.org/1999/html">
    <div class="wrapper">

        <h2 id="embed">Recommended approach: embed code</h2>

            <p>The easiest way to include ImpactStory metrics on a webpage is via our embed code, shown below. There's just two steps:</p>
            <ol>
               <li>Paste this script at the top of your page:
               <div class="rawembedcode"><pre class="prettyprint">
{{'<script type="text/javascript" src="http://impactstory.org/embed/v1/impactstory.js"></script>'|escape()}}
            </pre></div>
                  </li>
               <li>
                  Paste this div where you want the badges to show.
                  <div class="rawembedcode"><pre class="prettyprint">
{{'<div class="impactstory-embed" data-id="19210768" data-id-type="pmid" data-api-key="API-DOCS"></div>'|escape()}}
            </pre></div>
               </li>
            </ol>


       <p>To use the widget, just <a href="mailto:team@impactstory.org?subject=API key request">get your free API key</a>
          and embed the widget on your page. This free API key works for 1000 unique items;
          for more than that, you can pay a <a href="/pricing">cost-recovery fee</a> and
          and <em>register</em> the additional items.</p>

       <p>There are two ways to register additional items:</p>
       <ul>
          <li>register a DOI range (like â€œ10.myjournal.*) with us directly (<a href="mailto:team@impactstory.org">contact us</a> for details), or</li>
          <li>register items individually using our <a href="http://docs.impactstory.apiary.io">REST API</a>.</li>
       </ul>


       <h3>Example</h3>
       <script type="text/javascript" src="http://{{ webapp_root }}/embed/v1/impactstory.js"></script>
       <div class="example">
          <div class="impactstory-embed" data-id="19210768" data-id-type="pmid" data-api-key="API-DOCS" ></div>
          <p>To the left, you can see the result, embedded live on this page: metrics for a sample article,
             <a href="http://impactstory.org/item/pmid/19210768">"Mega-phylogeny approach for comparative
                biology: an alternative to supertree and supermatrix approaches."</a>
             Hover over each badge to see a brief description; to dive in deeper, click and you'll reach the
             item page, which has more details, explanation, and context.
          </p>
             <p>You can embed badges next to multiple items on the
             same page, which is handy for CVs or tables of contents; for example, here are badges for another article,
             <a href="http://impactstory.org/item/doi/10.1002/mrc.2260">Multistep correlations via covariance processing of COSY/GCOSY spectra: opportunities and artifacts</a>
                <span class="impactstory-embed inline" data-id="10.1002/mrc.2260" data-id-type="doi" data-api-key="API-DOCS" data-badge-size="small" data-show-logo="false"></span>.
            You can display badges inline like this by embedding them as a span instead of a div (keeping everything else the same).
          </p>
       </div>

       <h3>Required attributes</h3>
       <p>The embedding script requires three parameters, which are fed in via <code>data-</code> attributes in the embedded div</code>:</p>
         <ul id="required-attributes">
            <li><code>data-id</code> uniquely identifies the items you want metrics form. We accept several types of ID,
               including <a href="http://en.wikipedia.org/wiki/PubMed#PubMed_identifier">PubMed ID</a>,
                <a href="http://en.wikipedia.org/wiki/Digital_object_identifier">DOI</a>,
               and GitHub repo (expressed as "username,reponame"). If there's another type of identifier you'd like
               to see supported, let us know; we'll be adding more. </li>
            <li><code>data-id-type</code> is the type of identifier you've used; it must be one of
               <code>doi</code>, <code>pmid</code>, or <code>github</code>.</li>
            <li><code>data-api-key</code> is the unique key we've assigned your organization. It's easy and free to get
            one; just <a href="javascript:UserVoice.showPopupWidget();">submit a ticket</a> or
               <a href="mailto:team@impactstory.org">drop us an email</a>. Of course, since the key
               will be served along with your page, it's not really secret, but it's helpful for us
               in debugging and tracking usage.</code></li>
         </ul>





       <h3>Optional attributes</h3>
       <p>You can also customize the display of badges using one of several of optional <code>data-</code> attributes:</p>

            <table>
               <tr><th>Attribute</th><th>Does</th><th>Looks like</th></tr>
               <tr>
                  <td class="attr">
                     <code>data-badge-size</code>
                  </td>
                  <td>
                     <p>Set to <code>"small"</code> to display smaller badges.</p>
                  </td>
                  <td class="example">
                     <div class="impactstory-embed" data-id="10.1002/mrc.2260" data-id-type="doi" data-badge-size="small" data-api-key="API-DOCS"></div>
                  </td>
               </tr>
               <tr>
                  <td class="attr">
                     <code>data-on-finish</code>
                  </td>
                  <script type="text/javascript">
                     countHighlys = function(dict, div$) {
                        div$.append(
                           "<div>"
                                   + dict.awards.big.length
                                   + "&nbsp;highlys!</div>"
                        )
                     }
                  </script>
                  <td>
                     <p>The name of a javascript callback to run, defined in the global (window) namespace.
                        The function will be fed two arguments: a <code>dict</code> object that includes all underlaying data used
                        in assigning the badges, and a <code>div$</code> jQuery object representing this div.
                        For instance, if you define this script:
                        <pre class="prettyprint">
countHighlys = function(dict, div$) {
   div$.append(
      "&lt;div&gt;" +dict.awards.big.length+ "&nbsp;highlys!&lt;/div&gt;"
   )
}
                        </pre> and then include <code>data-on-finish="countHighlys"</code> in your ImpactStory div,
                        the <code>countHighlys</code> function runs when the badges are done loading.</p>
                  </td>
                  <td class="example">
                     <div class="impactstory-embed" data-id="10.1002/mrc.2260" data-id-type="doi" data-api-key="API-DOCS" data-badge-size="small" data-on-finish="countHighlys"></div>
                  </td>
               </tr>
               <tr>
                  <td class="attr">
                     <code>data-verbose-badges</code>
                  </td>
                  <td>
                     <p>Set to <code>true</code> to make badges explicitly report the <em>audience</em> they apply to, instead
                     of just relying on color-coding and tooltips.</p>
                  </td>
                  <td class="example">
                     <div class="impactstory-embed" data-id="10.1002/mrc.2260" data-id-type="doi" data-badge-size="small" data-api-key="API-DOCS" data-verbose-badges="true"></div>
                  </td>
               <tr>
                  <td class="attr">
                     <code>data-show-logo</code>
                  </td>
                  <td>
                     <p>Set to <code>false</code> to hide the ImpactStory logo.</p>
                  </td>
                  <td class="example">
                     <div class="impactstory-embed" data-id="10.1002/mrc.2260" data-id-type="doi" data-badge-size="small" data-api-key="API-DOCS" data-show-logo="false"></div>
                  </td>
               </tr>
               <tr>
                  <td class="attr">
                     <code>data-show-badges</code>
                  </td>
                  <td>
                     <p>Set to <code>false</code> to hide the ImpactStory badges. Clicking the logo will
                        still open a new tab showing this item's report page on impactstory.org.</p>
                  </td>
                  <td class="example">
                     <div class="impactstory-embed" data-id="10.1002/mrc.2260" data-id-type="doi" data-badge-size="small" data-api-key="API-DOCS" data-show-badges="FALSE"></div>
                  </td>
               </tr>
               </tr>
            </table>



        <div class="example"> <!--it's not an example, but sort of follows the same flow... -->

            <p>
               If you've got any feedback, ideas, or questions,
               <a href="javascript:UserVoice.showPopupWidget();"
                  title="Open feedback & support dialog (powered by UserVoice)">let us know!</a>
               We're planning to roll out alternative sizes and styles of badges in the near future,
               and we'd love any comments.
            </p>
        </div>

        <h2 id="api">More versatile approach: REST api.</h2>

        <p>
            If the embed code described above doesn't meet your needs, you can use our API directly.  The ImpactStory webapp itself is built directly on top of this API. 
        </p><p>
            <a target="_blank" href="http://docs.impactstory.apiary.io/">Documentation</a> for current version of the REST API (/v1).
        </p>
    </div>
</div>

{% endblock %}
