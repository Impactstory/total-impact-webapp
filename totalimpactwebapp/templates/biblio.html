<div class="biblio">
   <h5 class="title">
      <!-- if embedded, open product page in a new tab -->
      <a class="title-text target-blank"

{#         {% if request.args.get('embedded') in ['true', 'True', 1] %}#}
{#         target="_blank"#}
{#         {% endif %}#}

         title="Click to view impact details"
         data-toggle='tooltip'

         href="/{{ url_slug }}/product/{{ product_id }}">

         {{biblio.title}}
      </a>


      {% if biblio.url %}
      <a class="linkout url title"
         target="_blank"
         title="Click to view on publisher site"
         data-toggle='tooltip'
         href="{{ url }}">
         <i class="icon-external-link-sign"></i>
      </a>
      {% endif %}

      {% if free_fulltext_url %}
      <a class="linkout free-fulltext-url"
         target="_blank"
         title="Free fulltext available!"
         data-toggle='tooltip'
         href="{{ free_fulltext_url }}">
         <i class="icon-unlock-alt"></i>
      </a>
      {% endif %}
   </h5>







   <div class="optional-biblio">
      {% if biblio.year %}
      <span class="year">({{ biblio.year }})</span>
      {% endif %}

      {% if biblio.authors and not biblio.embed %}
      <span class="authors">{{ biblio.authors }}.</span>
      {% endif %}


      {% if biblio.repository and not biblio.embed and not biblio.journal %}
      <span class="repository">{{ biblio.repository }}.</span>
      {% endif %}


      {% if biblio.journal %}
      <span class="journal">{{ biblio.journal }}</span>
      {% endif %}

      {% if biblio.description %}
      <span class="description">{{ biblio.description }}</span>
      {% endif %}


      {% if biblio.embed %}
      <!-- this is a temp method for embedding tweets -->
      <span class="embed">{{ biblio.embed | safe}}</span>
      {% endif %}
   </div>

   <div class="mendeley-reader-breakdowns">
      {% for metric in product.metrics | dictsort() %}
         {% if metric[0] in ["mendeley:discipline", "mendeley:country", "mendeley:career_stage"]  %}
            <div class="mendeley-reader-type-metric">
               <span class="metric-name">
                  {{ metric[1].display_interaction }}s:
               </span>
               {%  for reader_type_object in metric[1].historical_values.current.raw %}
                  <span class="reader-type-name-and-value">
                     <span class="reader-type-name">{{ reader_type_object.name }}</span>
                     <span class="reader-type-value">{{ (reader_type_object.value * 0.01 * product.metrics['mendeley:readers'].historical_values.current.raw) | round() | int()}}</span>,
                  </span>
               {% endfor %}
             </div>
         {% endif %}


      {% endfor %}

   </div>
</div>














