<div class="profile-header" ng-show="userExists">
   <div class="wrapper">
      <div class="loading" ng-show="!user.about.id">
         <div class="working"><i class="icon-refresh icon-spin"></i><span class="text">Loading profile info...</span></div>
      </div>
      <div class="my-picture" ng-show="user.about.id">
         <a href="http://www.gravatar.com" >
            <img class="gravatar" ng-src="http://www.gravatar.com/avatar/{{ user.about.email_hash }}?s=110&d=mm" data-toggle="tooltip" class="gravatar" rel="tooltip" title="Modify your icon at Gravatar.com" />
         </a>
      </div>
      <div class="my-vitals">
         <h2 class='page-title editable-name'>
            <span class="given-name editable" data-name="given_name">{{ user.about.given_name }}</span>
            <span class="surname editable" data-name="surname">{{ user.about.surname }}</span>
         </h2>
      </div>
      <div class="my-metrics"></div> <!-- profile-level stats go here -->
   </div>
</div>

<div class="product-controls" ng-show="products.length">
   <div class="wrapper">
      <div class="edit-controls btn-group">
         <div class="num-items">
            <span class="val-plus-text"><span class="value">{{ filterProducts(products).length }}</span> research products</span>
            <a ng-click="showProductsWithoutMetrics = !showProductsWithoutMetrics" ng-show="showProductsWithoutMetrics">
               (hide <span class="value">{{ filterProducts(products, "withoutMetrics").length }}</span> without metrics)
            </a>
         </div>
         <a><i class="icon-edit"></i>Edit</a>
      </div>
      <div class="view-controls">
         <a><i class="icon-refresh"></i>Refresh metrics</a>
         <span class="dropdown download">
            <a id="adminmenu" role="button" class="dropdown-toggle"><i class="icon-download"></i>Download</a>
            <ul class="dropdown-menu" role="menu" aria-labelledby="adminmenu">
               <li><a tabindex="-1" href="http://api.impactstory.org/v1/collection/{{ user.about.collection_id }}.csv?key=samplekey"><i class="icon-table"></i>csv</a></li>
               <li><a tabindex="-1" href="http://api.impactstory.org/v1/collection/{{ user.about.collection_id }}?key=samplekey"><i class="json">{&hellip;}</i>json</a></li>
            </ul>
         </span>
      </div>
   </div>
</div>

<div class="products" ng-show="userExists">
   <div class="wrapper">
      <div class="loading" ng-show="!products.length">
         <div class="working"><i class="icon-refresh icon-spin"></i><span class="text">Loading products...</span></div>
      </div>

      <ul class="products-list">
         <li class="product"
             ng-repeat="product in products | orderBy:[getGenre, 'isHeading', getBadgeCount]"
             ng-controller="productCtrl"
             ng-show="hasMetrics() || showProductsWithoutMetrics || product.isHeading"
             id="{{ product._id }}">

            <h2 class="product-heading {{ product.headingDimension }} {{ product.headingValue }}"
                ng-show="product.isHeading">
               <i class="icon-save software"></i>
               <i class="icon-file-text-alt article"></i>
               <i class="icon-table dataset"></i>
               {{ product.headingValue }}
            </h2>
            <div class="real-product" ng-show="!product.isHeading">
               <div class="biblio" ng-include="'product/biblio.tpl.html'"></div>
               <div class="badges" ng-include="'product/badges.tpl.html'"></div>
            </div>
         </li>
      </ul>
   </div>

   <div class="products-without-metrics wrapper" ng-show="products.length && !showProductsWithoutMetrics">
      <div class="well">
         Another <span class="value">{{ filterProducts(products, "withoutMetrics").length }}</span> products aren't shown, because we couldn't find any impact data for them.
         <a ng-click="showProductsWithoutMetrics = !showProductsWithoutMetrics">Show these, too.</a>
      </div>
   </div>


</div>

<div class="user-does-not-exist no-page" ng-show="!userExists">
   <h2>Whoops!</h2>
   <p>We don't have a user account for <span class="slug">'{{ slug }}.'</span><br> Would you like to <a href="/signup">make one?</a></p>

</div>